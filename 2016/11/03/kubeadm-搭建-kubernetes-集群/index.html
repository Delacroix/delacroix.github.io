<!DOCTYPE html>
<html>
    <head>
    <!--
        © Material Theme 
        https://github.com/viosey/hexo-theme-material
        Version: 1.2.5
    -->
    
    <!-- Title -->
    
    <title>
        kubeadm 搭建 kubernetes 集群 | Delacroix&#39;s Blog
    </title>
    
    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">
    
    <!-- Meta & INfo -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Delacroix">
    <meta name="description" content="Ŭ����Ϊһ��CCIE">
    <meta name="keywords" content="null">
    
    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">
    
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Delacroix&#39;s Blog">
    
    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://delacroix.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="kubeadm 搭建 kubernetes 集群 | Delacroix&#39;s Blog">
    <meta property="og:description" content="Ŭ����Ϊһ��CCIE">
    
     <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">
        
        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->
    
    <!-- Import CSS -->
    <link rel="stylesheet" href="/blog/css/material.min.css">
    <link rel="stylesheet" href="/blog/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
	body, html{
		font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
	}
	
    a{
        color: #00838F
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important
    }
    
	/* Sidebar User Drop Down Menu Text Color */
	#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus{
        color: #0097A7 !important
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a{
        color: #0097A7 !important
    }
    
    .toTop{
        background: #757575 !important
    }
		
	.material-layout .material-post>.material-nav,
	.material-layout .material-index>.material-nav,
	.material-nav a{
		color: #757575;
	}
		
	#scheme-Paradox .MD-burger-layer {
		background-color: #757575;
	}

	#scheme-Paradox #post-toc-trigger-btn{
		color: #757575;
	}
	
	.post-toc a:hover{
		color: #00838F;
		text-decoration: underline;
	}
</style>


<!-- Theme Background Related-->

    <style>
        body{
            background-color: #F5F5F5
        }
		
		/* blog_info bottom background */
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>

	<script src="/blog/js/jquery.min.js"></script>
	
	<link rel="stylesheet" href="/blog/css/highlight/solarized-white.css">
	
	<!-- UC Browser Compatible-->
	<script>
		var agent = navigator.userAgent.toLowerCase();
		if(agent.indexOf('ucbrowser')>0) {
			document.write('<link rel="stylesheet" href="/blog/css/uc.css">');
		   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
		}
	</script>
    
    <!-- Custom Head -->
    
</head>
	
	

    <body id="scheme-Paradox">

		
        <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
				
			
			
            <!-- Main Container -->
            <main class="material-layout__content" id="main">
				
                <!-- Top Anchor -->
                <div id="top"></div>
				
				
                <!-- Hamburger Button -->
                <button class="MD-burger-icon sidebar-toggle">
                    <span class="MD-burger-layer"></span>
                </button>
				
				
                <!-- Post TOC -->

    
	<!-- Back Button -->
<!--
	<div class="material-back" id="backhome-div" tabindex="0">
		<a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" href="#" onclick="window.history.back();return false;" target="_self" role="button" data-upgraded=",MaterialButton,MaterialRipple">
			<i class="material-icons" role="presentation">arrow_back</i>
			<span class="mdl-button__ripple-container">
				<span class="mdl-ripple"></span>
			</span>
		</a>
	</div>			
-->
	<!-- Left aligned menu below button -->
	<button id="post-toc-trigger-btn"
			class="mdl-button mdl-js-button mdl-button--icon">
	  <i class="material-icons">format_list_numbered</i>
	</button>

	<ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect"
		for="post-toc-trigger-btn">
			
			<ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#转-kubeadm-搭建-kubernetes-集群"><span class="post-toc-number">1.</span> <span class="post-toc-text">[转]kubeadm 搭建 kubernetes 集群</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-环境准备"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">1 环境准备</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-说点正经事"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">2 说点正经事</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-1-安装包从哪来"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">2.1 安装包从哪来</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-2-镜像从哪来"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">2.2 镜像从哪来</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-3-镜像版本怎么整"><span class="post-toc-number">1.2.3.</span> <span class="post-toc-text">2.3 镜像版本怎么整</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#三-搭建集群"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">三 搭建集群</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-1-主机名处理"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">3.1 主机名处理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-2-load-镜像"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">3.2 load 镜像</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-3-安装-rpm"><span class="post-toc-number">1.3.3.</span> <span class="post-toc-text">3.3 安装 rpm</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-4-初始化-master"><span class="post-toc-number">1.3.4.</span> <span class="post-toc-text">3.4 初始化 master</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-5-加入-node"><span class="post-toc-number">1.3.5.</span> <span class="post-toc-text">3.5 加入 node</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-6-部署-weave-网络"><span class="post-toc-number">1.3.6.</span> <span class="post-toc-text">3.6 部署 weave 网络</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-7-部署-dashboard"><span class="post-toc-number">1.3.7.</span> <span class="post-toc-text">3.7 部署 dashboard</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#四-其他的一些坑"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">四 其他的一些坑</span></a></li></ol></li></ol>
		
<!--			<li class="mdl-menu__item">Some Action</li>-->
	</ul>



<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">
		
        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
	<!-- Paradox Post Header -->
	
		
			<!-- Random Thumbnail -->
			<div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
				<script>
    
    var randomNum;
    randomNum = Math.floor(Math.random() * 19 + 1);
    
    $(".post_thumbnail-random").css('background-image', 'url(' + '/img/random/material-' + randomNum + '.png' + ')');
    
</script>

		
	
        <p class="article-headline-p">
            kubeadm 搭建 kubernetes 集群
        </p>
    </div>

	

				
				
					<!-- Paradox Post Info -->
					<div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Delacroix</strong>
        <span>11月 03, 2016</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
<!--
    <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button>
-->

    <!-- Qrcode -->
    


    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/blog/tags/Docker/">Docker</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/blog/tags/Kubernetes/">Kubernetes</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">

    

    

    <!-- Share Weibo -->
    
    <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=kubeadm 搭建 kubernetes 集群&url=https://delacroix.github.io/blog//blog/2016/11/03/kubeadm-搭建-kubernetes-集群/index.html&pic=&searchPic=false&style=simple" target="_blank">
        <li class="mdl-menu__item">
            分享到微博
        </li>
    </a>
    

    <!-- Share Twitter -->
    
    <a class="post_share-link" href="https://twitter.com/intent/tweet?text=kubeadm 搭建 kubernetes 集群&url=https://delacroix.github.io/blog//blog/2016/11/03/kubeadm-搭建-kubernetes-集群/index.html&via=Delacroix" target="_blank">
        <li class="mdl-menu__item">
            分享到 Twitter
        </li>
    </a>
    

    <!-- Share Facebook -->
    
    <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://delacroix.github.io/blog//blog/2016/11/03/kubeadm-搭建-kubernetes-集群/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Facebook
        </li>
    </a>
    

    <!-- Share Google+ -->
    
    <a class="post_share-link" href="https://plus.google.com/share?url=https://delacroix.github.io/blog//blog/2016/11/03/kubeadm-搭建-kubernetes-集群/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Google+
        </li>
    </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

				

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
	
		<h1 id="转-kubeadm-搭建-kubernetes-集群"><a href="#转-kubeadm-搭建-kubernetes-集群" class="headerlink" title="[转]kubeadm 搭建 kubernetes 集群"></a>[转]kubeadm 搭建 kubernetes 集群</h1><p>原作者链接：<a href="https://mritd.me/2016/10/29/set-up-kubernetes-cluster-by-kubeadm/" target="_blank" rel="external">点我</a></p>
<p>距离上一篇 kubernetes 1.4 集群搭建 发布间隔不算太久，自己也不断地在生产和测试环境鼓捣，有不少 “逗比” 的经历，准备写一下具体的 kubeadm 搭建集群的一些坑和踩坑的经验，如果没有使用过 kubeadm 的同学，最好先看下上面的文章，然后鼓捣一遍，也许并不会成功，但大部分坑再来看此文会有收获</p>
<h2 id="1-环境准备"><a href="#1-环境准备" class="headerlink" title="1 环境准备"></a>1 环境准备</h2><p>首先环境还是三台虚拟机，虚拟机地址如下</p>
<table>
<thead>
<tr>
<th style="text-align:left">IP 地址</th>
<th style="text-align:right">节点</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">192.168.1.167</td>
<td style="text-align:right">master</td>
</tr>
<tr>
<td style="text-align:left">192.168.1.189</td>
<td style="text-align:right">node1</td>
</tr>
<tr>
<td style="text-align:left">192.168.1.189</td>
<td style="text-align:right">node2</td>
</tr>
</tbody>
</table>
<a id="more"></a>
<p>然后每台机器安装好 docker，至于 rpm 安装包版本下面介绍</p>
<h2 id="2-说点正经事"><a href="#2-说点正经事" class="headerlink" title="2 说点正经事"></a>2 说点正经事</h2><h3 id="2-1-安装包从哪来"><a href="#2-1-安装包从哪来" class="headerlink" title="2.1 安装包从哪来"></a>2.1 安装包从哪来</h3><p>官方的文档页面更新并不及时，同时他的 yum 源更新也很慢，再者…那他妈可是 Google 的服务器，能特么连上吗？以前总是在国外服务器使用 yumdownloader 下载，然后 scp 到本地，虽然能解决问题，但是蛋碎一地…最后找到了源头，如下</p>
<p>Kubernetes 编译的各种发行版安装包来源于 Github 上的另一个叫 release 的项目，地址 点这里，把这个项目 clone 下来，由于本人是 Centos 用户，所以进入 rpm 目录，在安装好 docker 的机器上执行那个 docker-build.sh 脚本即可编译 rpm 包，最后会生成到当前目录的 output 目录下,截图如下</p>
<p><img src="/images/kubeadm/1478154271821.png" alt="Alt text"></p>
<p><img src="/images/kubeadm/1478154304939.png" alt="Alt text"></p>
<h3 id="2-2-镜像从哪来"><a href="#2-2-镜像从哪来" class="headerlink" title="2.2 镜像从哪来"></a>2.2 镜像从哪来</h3><p>对的，没错，gcr.io 就是 Google 的域名，服务器更不用提，所以在进行 kubeadm init 操作时如果不先把这些镜像 load 进去绝对会卡死不动，以下列出了所需镜像，但是版本号根据 rpm 版本不同可能略有不同，具体怎么看下面介绍</p>
<table>
<thead>
<tr>
<th style="text-align:left">镜像名称</th>
<th style="text-align:right">版本号</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">gcr.io/google_containers/kube-discovery-amd64</td>
<td style="text-align:right">1.0</td>
</tr>
<tr>
<td style="text-align:left">gcr.io/google_containers/kubedns-amd64</td>
<td style="text-align:right">1.7</td>
</tr>
<tr>
<td style="text-align:left">gcr.io/google_containers/kube-proxy-amd64</td>
<td style="text-align:right">v1.4.1</td>
</tr>
<tr>
<td style="text-align:left">gcr.io/google_containers/kube-scheduler-amd64</td>
<td style="text-align:right">v1.4.1</td>
</tr>
<tr>
<td style="text-align:left">gcr.io/google_containers/kube-controller-manager-amd64</td>
<td style="text-align:right">v1.4.1</td>
</tr>
<tr>
<td style="text-align:left">gcr.io/google_containers/kube-apiserver-amd64</td>
<td style="text-align:right">v1.4.1</td>
</tr>
<tr>
<td style="text-align:left">gcr.io/google_containers/etcd-amd64</td>
<td style="text-align:right">2.2.5</td>
</tr>
<tr>
<td style="text-align:left">gcr.io/google_containers/kube-dnsmasq-amd64</td>
<td style="text-align:right">1.3</td>
</tr>
<tr>
<td style="text-align:left">gcr.io/google_containers/exechealthz-amd64</td>
<td style="text-align:right">1.1</td>
</tr>
<tr>
<td style="text-align:left">gcr.io/google_containers/pause-amd64</td>
<td style="text-align:right">3.0</td>
</tr>
</tbody>
</table>
<p>这些镜像有两种办法可以获取，第一种是利用一台国外的服务器，在上面 pull 下来，然后再 save 成 tar 文件，最后 scp 到本地 load 进去；相对于第一种方式比较坑的是取决于服务器速度，每次搞起来也很蛋疼，第二种方式就是利用 docker hub 做中转，简单的说就是利用 docker hub 的自动构建功能，在 Github 中创建一个 Dockerfile，里面只需要 FROM xxxx 这些 gcr.io 的镜像即可，最后 pull 到本地，然后再 tag 一下</p>
<p>首先创建一个 github 项目，可以直接 fork 我的即可</p>
<p><img src="/images/kubeadm/1478154319541.png" alt="Alt text"></p>
<p>其中每个 Dockerfile 只需要 FROM 一下即可</p>
<p><img src="/images/kubeadm/1478154324755.png" alt="Alt text"></p>
<p>最后在 Docker Hub 上创建自动构建项目</p>
<p><img src="/images/kubeadm/1478154331006.png" alt="Alt text"></p>
<p><img src="/images/kubeadm/1478154337732.png" alt="Alt text"></p>
<p><img src="/images/kubeadm/1478154343818.png" alt="Alt text"></p>
<p><img src="/images/kubeadm/1478154350066.png" alt="Alt text"></p>
<p>最后要手动触发一下，然后 Docker Hub 才会开始给你编译</p>
<p><img src="/images/kubeadm/1478154355362.png" alt="Alt text"></p>
<p>等待完成即可直接 pull 了</p>
<p><img src="/images/kubeadm/1478154360794.png" alt="Alt text"></p>
<h3 id="2-3-镜像版本怎么整"><a href="#2-3-镜像版本怎么整" class="headerlink" title="2.3 镜像版本怎么整"></a>2.3 镜像版本怎么整</h3><p>上面已经解决了镜像获取问题，但是一大心病就是 “我特么怎么知道是哪个版本的”，为了发扬 “刨根问底” 的精神，先进行一遍 kubeadm init，这时候绝对卡死，此时进入 /etc/kubernetes/manifests 可以看到许多 json 文件，这些文件中定义了需要哪些基础镜像</p>
<p><img src="/images/kubeadm/1478154367061.png" alt="Alt text"></p>
<p><img src="/images/kubeadm/1478154372266.png" alt="Alt text"></p>
<p>从上图中基本可以看到 kubeadm init 的时候会拉取哪些基础镜像了，但是还有一些镜像，仍然无法找到，比如kubedns、pause 等，至于其他的镜像版本，可以从源码中找到，源码位置是 kubernetes/cmd/kubeadm/app/images/images.go 这个文件中，如下所示:</p>
<p><img src="/images/kubeadm/1478154378162.png" alt="Alt text"></p>
<p>剩余的一些镜像，比如 kube-proxy-amd64、kube-discovery-amd64 两个镜像，其中 kube-discovery-amd64 现在一直是 1.0 版本，源码如下所示</p>
<p><img src="/images/kubeadm/1478154385680.png" alt="Alt text"></p>
<p>kube-proxy-amd64 则是一直跟随基础组件的主版本，也就是说如果从 manifests 中看到 controller 等版本是 v.1.4.4，那么 kube-proxy-amd64 也是这个版本，源码如下</p>
<p><img src="/images/kubeadm/1478154397493.png" alt="Alt text"></p>
<p>最后根据这些版本去 github 上准备相应的 Dockerfile，在利用 Docker Hub 的自动构建 build 一下，再 pull 下来 tag 成对应的镜像名称即可</p>
<h2 id="三-搭建集群"><a href="#三-搭建集群" class="headerlink" title="三 搭建集群"></a>三 搭建集群</h2><h3 id="3-1-主机名处理"><a href="#3-1-主机名处理" class="headerlink" title="3.1 主机名处理"></a>3.1 主机名处理</h3><p>经过亲测，节点主机名最好为 xxx.xxx 这种域名格式，否则在某些情况下，POD 中跑的程序使用域名解析时可能出现问题，所以先要处理一下主机名</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#写入 hostname(node 节点后缀改成 .node)</div><div class="line">echo "192<span class="string">-168</span><span class="string">-1</span><span class="string">-167</span>.master" &gt; /etc/hostname </div><div class="line">#加入 hosts</div><div class="line">echo "127.0.0.1   192<span class="string">-168</span><span class="string">-1</span><span class="string">-167</span>.master" &gt;&gt; /etc/hosts</div><div class="line">#不重启情况下使内核生效</div><div class="line">sysctl kernel.hostname=192<span class="string">-168</span><span class="string">-1</span><span class="string">-167</span>.master</div><div class="line">#验证是否修改成功</div><div class="line">➜  ~ hostname</div><div class="line">192<span class="string">-168</span><span class="string">-1</span><span class="string">-167</span>.master</div></pre></td></tr></table></figure>
<h3 id="3-2-load-镜像"><a href="#3-2-load-镜像" class="headerlink" title="3.2 load 镜像"></a>3.2 load 镜像</h3><p>由于本人已经在 Docker Hub 上处理好了相关镜像，所以直接 pull 下来 tag 一下即可，</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">images=(kube-proxy-<span class="string">amd64:</span>v1<span class="number">.4</span><span class="number">.4</span> kube-discovery-<span class="string">amd64:</span><span class="number">1.0</span> kubedns-<span class="string">amd64:</span><span class="number">1.7</span> kube-scheduler-<span class="string">amd64:</span>v1<span class="number">.4</span><span class="number">.4</span> kube-controller-manager-<span class="string">amd64:</span>v1<span class="number">.4</span><span class="number">.4</span> kube-apiserver-<span class="string">amd64:</span>v1<span class="number">.4</span><span class="number">.4</span> etcd-<span class="string">amd64:</span><span class="number">2.2</span><span class="number">.5</span> kube-dnsmasq-<span class="string">amd64:</span><span class="number">1.3</span> exechealthz-<span class="string">amd64:</span><span class="number">1.1</span> pause-<span class="string">amd64:</span><span class="number">3.0</span> kubernetes-dashboard-<span class="string">amd64:</span>v1<span class="number">.4</span><span class="number">.1</span>)</div><div class="line"><span class="keyword">for</span> imageName <span class="keyword">in</span> $&#123;images[@]&#125; ; do</div><div class="line">  docker pull mritd/$imageName</div><div class="line">  docker tag mritd<span class="regexp">/$imageName gcr.io/</span>google_containers/$imageName</div><div class="line">  docker rmi mritd/$imageName</div><div class="line">done</div></pre></td></tr></table></figure>
<h3 id="3-3-安装-rpm"><a href="#3-3-安装-rpm" class="headerlink" title="3.3 安装 rpm"></a>3.3 安装 rpm</h3><p>rpm 获取办法上文已经提到，可以自己编译，这里我已经编译好并维护了一个 yum 源，直接yum install 即可(懒)</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#添加 yum 源</span></div><div class="line">tee /etc/yum.repos.d/mritd.repo &lt;&lt; EOF</div><div class="line">[mritdrepo]</div><div class="line">name=Mritd Repository</div><div class="line">baseurl=https://rpm.mritd.me/centos/7/x86_64</div><div class="line">enabled=1</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=https://cdn.mritd.me/keys/rpm.public.key</div><div class="line">EOF</div><div class="line"><span class="comment">#刷新cache</span></div><div class="line">yum makecache</div><div class="line"><span class="comment">#安装</span></div><div class="line">yum install -y kubelet kubectl kubernetes-cni kubeadm</div></pre></td></tr></table></figure>
<h3 id="3-4-初始化-master"><a href="#3-4-初始化-master" class="headerlink" title="3.4 初始化 master"></a>3.4 初始化 master</h3><p>等会有个坑，kubeadm 等相关 rpm 安装后会生成 /etc/kubernetes 目录，而 kubeadm init 时候又会检测这些目录是否存在，如果存在则停止初始化，所以要先清理一下，以下清理脚本来源于 官方文档 Tear down 部分，该脚本同样适用于初始化失败进行重置</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">systemctl stop kubelet;</div><div class="line"><span class="comment">#注意: 下面这条命令会干掉所有正在运行的 docker 容器，</span></div><div class="line"><span class="comment">#如果要进行重置操作，最好先确定当前运行的所有容器都能干掉(干掉不影响业务)，</span></div><div class="line"><span class="comment">#否则的话最好手动删除 kubeadm 创建的相关容器(gcr.io 相关的)</span></div><div class="line">docker rm -f -v $(docker ps -q);</div><div class="line">find /var/<span class="class"><span class="keyword">lib</span>/<span class="title">kubelet</span> | <span class="title">xargs</span> -<span class="title">n</span> 1 <span class="title">findmnt</span> -<span class="title">n</span> -<span class="title">t</span> <span class="title">tmpfs</span> -<span class="title">o</span> <span class="title">TARGET</span> -<span class="title">T</span> | <span class="title">uniq</span> | <span class="title">xargs</span> -<span class="title">r</span> <span class="title">umount</span> -<span class="title">v</span>;</span></div><div class="line">rm -r -f /etc/kubernetes /var/<span class="class"><span class="keyword">lib</span>/<span class="title">kubelet</span> /<span class="title">var</span>/<span class="title">lib</span>/<span class="title">etcd</span>;</span></div></pre></td></tr></table></figure>
<p>还有个坑，初始化以前记得一定要启动 kubelet，虽然你 systemctl status kubelet 看着他是启动失败，但是也得启动，否则绝壁卡死</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">systemctl <span class="built_in">enable</span> kubelet</div><div class="line">systemctl start kubelet</div></pre></td></tr></table></figure>
<p>等会等会，还有坑，新版本直接 init 会提示 ebtables not found in system path 错误，所以还得先安装一下这个包在初始化</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#安装 ebtables</span></div><div class="line">yum <span class="keyword">install</span> -y ebtables</div></pre></td></tr></table></figure>
<p>最后见证奇迹的时刻</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#初始化并指定 <span class="selector-tag">apiserver</span> 监听地址</div><div class="line"><span class="selector-tag">kubeadm</span> <span class="selector-tag">init</span> <span class="selector-tag">--api-advertise-addresses</span> 192<span class="selector-class">.168</span><span class="selector-class">.1</span><span class="selector-class">.167</span></div></pre></td></tr></table></figure>
<p>完美截图如下</p>
<p><img src="/images/kubeadm/1478154409993.png" alt="Alt text"></p>
<p>这里再爆料一个坑，底下的 kubeadm join –token=b17964.5d8a3c14e99cf6aa 192.168.1.167 这条命令一定保存好，因为后期没法重现的，你们老大再让你添加机器的时候如果没这个你会哭的</p>
<h3 id="3-5-加入-node"><a href="#3-5-加入-node" class="headerlink" title="3.5 加入 node"></a>3.5 加入 node</h3><p>上面所有坑大约说的差不多了，直接上命令了</p>
<p><strong>处理主机名</strong></p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">echo "192<span class="string">-168</span><span class="string">-1</span><span class="string">-189</span>.node" &gt; /etc/hostname </div><div class="line">echo "127.0.0.1   192<span class="string">-168</span><span class="string">-1</span><span class="string">-189</span>.node" &gt;&gt; /etc/hosts</div><div class="line">sysctl kernel.hostname=192<span class="string">-168</span><span class="string">-1</span><span class="string">-189</span>.node</div></pre></td></tr></table></figure>
<p><strong>拉取镜像</strong></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">images=(kube-proxy-<span class="string">amd64:</span>v1<span class="number">.4</span><span class="number">.4</span> kube-discovery-<span class="string">amd64:</span><span class="number">1.0</span> kubedns-<span class="string">amd64:</span><span class="number">1.7</span> kube-scheduler-<span class="string">amd64:</span>v1<span class="number">.4</span><span class="number">.4</span> kube-controller-manager-<span class="string">amd64:</span>v1<span class="number">.4</span><span class="number">.4</span> kube-apiserver-<span class="string">amd64:</span>v1<span class="number">.4</span><span class="number">.4</span> etcd-<span class="string">amd64:</span><span class="number">2.2</span><span class="number">.5</span> kube-dnsmasq-<span class="string">amd64:</span><span class="number">1.3</span> exechealthz-<span class="string">amd64:</span><span class="number">1.1</span> pause-<span class="string">amd64:</span><span class="number">3.0</span> kubernetes-dashboard-<span class="string">amd64:</span>v1<span class="number">.4</span><span class="number">.1</span>)</div><div class="line"><span class="keyword">for</span> imageName <span class="keyword">in</span> $&#123;images[@]&#125; ; do</div><div class="line">  docker pull mritd/$imageName</div><div class="line">  docker tag mritd<span class="regexp">/$imageName gcr.io/</span>google_containers/$imageName</div><div class="line">  docker rmi mritd/$imageName</div><div class="line">done</div></pre></td></tr></table></figure>
<p><strong>装 rpm</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">tee /etc/yum<span class="selector-class">.repos</span><span class="selector-class">.d</span>/mritd<span class="selector-class">.repo</span> &lt;&lt; EOF</div><div class="line">[mritdrepo]</div><div class="line">name=Mritd Repository</div><div class="line">baseurl=https:<span class="comment">//rpm.mritd.me/centos/7/x86_64</span></div><div class="line">enabled=<span class="number">1</span></div><div class="line">gpgcheck=<span class="number">1</span></div><div class="line">gpgkey=https:<span class="comment">//cdn.mritd.me/keys/rpm.public.key</span></div><div class="line">EOF</div><div class="line">yum makecache</div><div class="line">yum install -y kubelet kubectl kubernetes-cni kubeadm ebtables</div></pre></td></tr></table></figure>
<p><strong>清理目录(没初始化过只需要删目录)</strong></p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rm -r -f /etc/kubernetes /var/<span class="class"><span class="keyword">lib</span>/<span class="title">kubelet</span> /<span class="title">var</span>/<span class="title">lib</span>/<span class="title">etcd</span>;</span></div></pre></td></tr></table></figure>
<p><strong>启动 kubelet</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">systemctl <span class="built_in">enable</span> kubelet</div><div class="line">systemctl start kubelet</div></pre></td></tr></table></figure>
<p><strong>初始化加入集群</strong></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kubeadm join --token=b17964<span class="number">.5</span>d8a3c14e99cf6aa <span class="number">192.168</span><span class="number">.1</span><span class="number">.167</span></div></pre></td></tr></table></figure>
<p>同样完美截图</p>
<p><img src="/images/kubeadm/1478154421337.png" alt="Alt text"></p>
<p><img src="/images/kubeadm/1478154426189.png" alt="Alt text"></p>
<h3 id="3-6-部署-weave-网络"><a href="#3-6-部署-weave-网络" class="headerlink" title="3.6 部署 weave 网络"></a>3.6 部署 weave 网络</h3><p>再没部署 weave 时，dns 是启动不了的，如下</p>
<p><img src="/images/kubeadm/1478154432781.png" alt="Alt text"></p>
<p>官方给出的命令是这样的</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kubectl <span class="keyword">create</span> -f https:<span class="comment">//git.io/weave-kube</span></div></pre></td></tr></table></figure>
<p>本着 “刨根问底挖祖坟” 的精神，先把这个 yaml 搞下来</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget <span class="string">https:</span><span class="comment">//git.io/weave-kube -O weave-kube.yaml</span></div></pre></td></tr></table></figure>
<p>然后同样的套路，打开看一下镜像，利用 Docker Hub 做中转，搞下来再 load 进去，然后 create -f 就行了</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">docker pull mritd/weave-<span class="string">kube:</span><span class="number">1.7</span><span class="number">.2</span></div><div class="line">docker tag mritd<span class="regexp">/weave-kube:1.7.2 weaveworks/</span>weave-<span class="string">kube:</span><span class="number">1.7</span><span class="number">.2</span></div><div class="line">docker rmi mritd/weave-<span class="string">kube:</span><span class="number">1.7</span><span class="number">.2</span></div><div class="line">kubectl create -f weave-kube.yaml</div></pre></td></tr></table></figure>
<p>完美截图</p>
<p><img src="/images/kubeadm/1478154439419.png" alt="Alt text"></p>
<h3 id="3-7-部署-dashboard"><a href="#3-7-部署-dashboard" class="headerlink" title="3.7 部署 dashboard"></a>3.7 部署 dashboard</h3><p>dashboard 的命令也跟 weave 的一样，不过有个大坑，默认的 yaml 文件中对于 image 拉取策略的定义是 无论何时都会去拉取镜像，导致即使你 load 进去也无卵用，所以还得先把 yaml 搞下来然后改一下镜像拉取策略，最后再 create -f 即可</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget https:<span class="regexp">//</span>rawgit.com<span class="regexp">/kubernetes/</span>dashboard<span class="regexp">/master/</span>src<span class="regexp">/deploy/</span>kubernetes-dashboard.yaml -O kubernetes-dashboard.yaml</div></pre></td></tr></table></figure>
<p>编辑 yaml 改一下 imagePullPolicy，把 Always 改成 IfNotPresent(本地没有再去拉取) 或者 Never(从不去拉取) 即可</p>
<p><img src="/images/kubeadm/1478154446474.png" alt="Alt text"></p>
<p>最后再利用 Dokcer Hub 中转，然后创建(实际上 dashboard 已经有了 v1.4.1，我这里已经改了)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kubectl create <span class="_">-f</span> kubernetes-dashboard.yaml</div></pre></td></tr></table></figure>
<p>截图如下</p>
<p><img src="/images/kubeadm/1478154451592.png" alt="Alt text"></p>
<p>通过 describe 命令我们可以查看其暴露出的 NodePoint,然后便可访问</p>
<p><img src="/images/kubeadm/1478154456805.png" alt="Alt text"></p>
<p><img src="/images/kubeadm/1478154460781.png" alt="Alt text"></p>
<h2 id="四-其他的一些坑"><a href="#四-其他的一些坑" class="headerlink" title="四 其他的一些坑"></a>四 其他的一些坑</h2><p>还有一些其他的坑等着大家去摸索，其中有一个是 DNS 解析错误，表现形式为 POD 内的程序通过域名访问解析不了，cat 一下容器的 /etc/resolv.conf发现指向的 dns 服务器与 kubectl get svc –namespace=kube-system 中的 kube-dsn 地址不符；解决办法就是 编辑节点的 /etc/systemd/system/kubelet.service.d/10-kubeadm.conf 文件，更改 KUBELET_DNS_ARGS 地址为 get svc 中的 kube-dns 地址，然后重启 kubelet 服务，重新杀掉 POD 让 kubernetes 重建即可<br><img src="/images/kubeadm/1478154465762.png" alt="Alt text"></p>
<p>其他坑欢迎大家补充</p>

	
	
	
	
</div>
				
				

                <!-- Post Comments -->
                
                    


                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
    <!-- Prev Nav -->
    
        <a href="/blog/2016/11/04/LOGSTASH-ELASTICSEARCH-处理-MYSQL-慢查询日志/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/blog/2016/11/03/LVS集群中的IP负载均衡技术-1/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>
        </div>
    </div>

				
				
					<!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay "></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored  sidebar-fixed-left" role="navigation">
	<div id="sidebar-main">
	    <!-- Sidebar Header -->
		<div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Delacroix's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        youremail@email.com
        <b class="caret"></b>
    </a>
</div>

		<!-- Sidebar Navigation  -->
		<ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
			
                <li>
                    <a href="#" target="_blank" title="Email Me">
						<i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/blog/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
             主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
<!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
-->


    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/blog/archives/2017/01/">一月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/blog/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/blog/archives/2016/11/">十一月 2016<span class="sidebar_archives-count">5</span></a>
        </ul>
    </li>

    <!-- Categories  -->
    

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
             文章总数
             <span class="sidebar-badge">9</span>
        </a>
    </li>
</ul>


		<!-- Sidebar Divider -->
		<div class="sidebar-divider"></div>

		<!-- Sidebar Footer -->
		<!-- 
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :) 
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		sidebar.help
		<span class="mdl-button__ripple-container">
			<span class="mdl-ripple"></span>
		</span>
	</div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

	</div>
    
    <!-- Sidebar Sponsor -->
    


</aside>

				
				
				
					<!-- Footer Top Button -->
					<div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>
				
				
				<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
	
	
		<!-- Paradox Footer Left Section -->
		<div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
    <a href="https://twitter.com/twitter" target="_blank"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-twitter.png);">
        <span class="visuallyhidden">Twitter</span>
    </button></a>
    

    <!-- Facebook -->
    
    <a href="https://www.facebook.com/facebook" target="_blank"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-facebook.png);">
        <span class="visuallyhidden">Facebook</span>
    </button></a>
    

    <!-- Google + -->
    
    <a href="https://www.google.com/" target="_blank"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-gplus.png);">
        <span class="visuallyhidden">Google Plus</span>
    </button></a>
    

    <!-- Weibo -->
    
    

    <!-- Instagram -->
    
    

    <!-- Tumblr -->
    
    

    <!-- Github -->
    
    

    <!-- LinkedIn -->
    
    

    <!-- Zhihu -->
    
    
</div>


		<!--Copyright-->
		<div id="copyright">Copyright&nbsp;©&nbsp;<script type="text/javascript">var fd = new Date();document.write(fd.getFullYear());</script>&nbsp;Delacroix's Blog</div>

		<!-- Paradox Footer Right Section -->

		<!-- 
		I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
		It will not impact the appearance and can give developers a lot of support :)

		很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
		它不会影响美观并可以给开发者很大的支持。 :) 
		-->

		<div class="mdl-mini-footer--right-section">
			<div>
				<div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
				<div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
			</div>
		</div>
	
    
</footer>
                
				<!-- Import File -->
<script src="/blog/js/highlight.min.js"></script>
<script src="/blog/js/js.min.js"></script>
<script src="/blog/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    
    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });
    
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>











<!-- Swiftye -->


<!-- Local Search-->


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $(".post-toc-wrap").parent(".mdl-menu__container").css("position", "fixed");
    });
</script>

<!-- MathJax Load-->

            </main>
        </div>
		
    </body>
		
	
</html>
